MODELS='resnet18_bn_cifar resnet18_id_cifar'
#### NON-ROBUST DATASET ####
# for model in $MODELS;
# do
#   python3 train_model.py \
#     --dataset d_non_robust_cifar \
#     --arch $model \
#     --evaluation-dataset cifar10 \
#     --epochs 150 \
#     --batch-size 128 \
#     --learning-rate 0.01 \
#     --weight-decay 5e-4 \
#     --schedule 50 100 \
#     --gamma 0.1 \
#     --record-ligs True \
#     --eval-pgd-l2 True \
#     --eval-pgd-linf True \
#     --subfolder bn
# done

#### ROBUST DATASET ####
for model in $MODELS;
do
  python3 train_model.py \
    --dataset d_robust_cifar \
    --arch $model \
    --evaluation-dataset cifar10 \
    --epochs 150 \
    --batch-size 128 \
    --learning-rate 0.01 \
    --weight-decay 5e-4 \
    --schedule 50 100 \
    --gamma 0.1 \
    --record-ligs True \
    --eval-pgd-l2 True \
    --eval-pgd-linf True \
    --subfolder bn
done

# #### DDET DATASET ####
# for model in $MODELS;
# do
#   python3 train_model.py \
#     --dataset ddet_cifar \
#     --arch $model \
#     --evaluation-dataset cifar10 \
#     --epochs 150 \
#     --batch-size 128 \
#     --learning-rate 0.1 \
#     --weight-decay 5e-4 \
#     --schedule 50 100 \
#     --gamma 0.1 \
#     --augmentation False \
#     --record-ligs True \
#     --eval-pgd-l2 True \
#     --eval-pgd-linf True \
#     --subfolder bn
#     # --ddet_eval True \
# done

### DRAND DATASET ####
for model in $MODELS;
do
  python3 train_model.py \
    --dataset drand_cifar \
    --arch $model \
    --evaluation-dataset cifar10 \
    --epochs 150 \
    --batch-size 128 \
    --learning-rate 0.01 \
    --weight-decay 5e-4 \
    --schedule 50 100 \
    --gamma 0.1 \
    --record-ligs True \
    --eval-pgd-l2 True \
    --eval-pgd-linf True \
    --subfolder bn
done
